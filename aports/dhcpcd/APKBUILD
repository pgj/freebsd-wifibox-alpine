# Maintainer: Gabor Pali <pali.gabor@gmail.com>
pkgname=dhcpcd
pkgver=10.1.0
pkgrel=1 # base: 1
pkgdesc="RFC2131 compliant DHCP client"
url="https://roy.marples.name/projects/dhcpcd"
arch="all"
license="BSD-2-Clause"
makedepends="linux-headers bsd-compat-headers"
install=
source="$pkgname-$pkgver.tar.gz::https://github.com/NetworkConfiguration/dhcpcd/archive/refs/tags/v$pkgver.tar.gz
	busybox-logger.patch
	dhcpcd.initd
	99-udhcpd.conf
	99-radvd.conf
	"

build() {
	./configure \
		--build=$CBUILD \
		--host=$CHOST \
		--sysconfdir=/etc \
		--mandir=/usr/share/man \
		--localstatedir=/var \
		--libexecdir=/usr/lib/$pkgname \
		--dbdir=/var/lib/$pkgname \
		--rundir=/run/dhcpcd \
		--runstatedir=/run/dhcpcd \
		--disable-seccomp \
		--enable-ipv6 \
		--enable-privsep \
		--without-dev \
		--without-udev
	make
}

package() {
	make DESTDIR="$pkgdir" proginstall
	install -Dm755 "$srcdir"/dhcpcd.initd \
		"$pkgdir"/etc/init.d/dhcpcd
	install -Dm555 "$srcdir"/99-udhcpd.conf \
		"$pkgdir"/usr/lib/dhcpcd/dhcpcd-hooks/99-udhcpd.conf
	install -Dm555 "$srcdir"/99-radvd.conf \
		"$pkgdir"/usr/lib/dhcpcd/dhcpcd-hooks/99-radvd.conf
	ln -s /media/etc/dhcpcd.conf "$pkgdir"/etc
}

sha512sums="
c3593ebf5a2a99a2b225b1963d596da91e7db76b622f49d3edc5382df0038da4a28e883574d3829d86643791970e20ce833ea55c753625f5f9b568b0abff9e92  dhcpcd-10.1.0.tar.gz
b6bdaac9fc0d5d2d7e8c5e30d1a45db1cff2284d01f92f8821b2f03aaff4e0dbd8cbfbced96d8d9d934dc11f22b792a8345d634d8e4e3b84f43016b7e866e302  busybox-logger.patch
7fb44b82a6fa25ee6249fc4835853a4c1fc7d327653efabd9fde303b1f306b3aa6956b2621b55a24fc007ec7ad878ce50e7418ebff0b17fece76e2fdd9e5190d  dhcpcd.initd
ceaf35c3b4fff7c1f156ed53003c19d24aa77234d0ac0b5d1886a96e0dab4865431502791c7874c90bffdf652ef001f0cacebbdb1fee883f10344d603fe2feb3  99-udhcpd.conf
074b3466bb9612131c83207f482b7b025513933be7b23be0ac2adb5ea96a761d81674dac3f891aba69b99e7aa33e2eaebd6702af2a49abe3eecddf528afd5afd  99-radvd.conf
"
