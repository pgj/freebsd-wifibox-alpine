# Maintainer: Gabor Pali <pali.gabor@gmail.com>

pkgname='rtl8821ce'
pkgver=20250820
_kern_maj=6
_kern_min=12
_kern_pcs=48
_kern_rel=0
_drv_rel=0
pkgrel=$(printf "%02d%02d%03d%02d%02d" $_kern_maj $_kern_min $_kern_pcs $_kern_rel $_drv_rel)
_gitrev='5df613d114d1ca6072aeaf9f64666029896eed61'
pkgdesc='Driver for Realtek 8821CE, an 802.11ac device'
arch='x86_64'
url='https://github.com/tomaspinho/rtl8821ce'
license='GPL-2.0'
makedepends="linux-lts-dev~$_kern_maj.$_kern_min.$_kern_pcs-r$_kern_rel xz"
depends="linux-lts~$_kern_maj.$_kern_min.$_kern_pcs-r$_kern_rel"
install=
options="!check !strip"
source="https://github.com/tomaspinho/rtl8821ce/archive/${_gitrev}.zip"

_kver="$_kern_maj.$_kern_min.$_kern_pcs-$_kern_rel-lts"
_kbase="/lib/modules/${_kver}"
_srcdir="$srcdir/rtl8821ce-$_gitrev"

build() {
  make -C "$_srcdir" -j8 KVER="$_kver"
}

package() {
  xz -C crc32 "$_srcdir"/*.ko
  install -p -D -m 644 "$_srcdir"/*.ko.xz -t "$pkgdir"/lib/modules/"$_kver"/kernel/drivers/net/wireless/realtek/rtl8821ce
}

sha512sums="
21a13e34c9c450d177273238ba9f40712c16ecf6d7a7d6d44fc8b4d2ec9622480ef8b3ac4e6fa7ae0a07233f191b25dc9eebec021b37a01e122bd249a1d6b35b  5df613d114d1ca6072aeaf9f64666029896eed61.zip
"
